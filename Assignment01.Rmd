---
title: "P4330_Assignment01"
author: "Ken Suzuki"
date: "2023-10-21"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, message = FALSE)

# List of required functions
library(flexplot) 
library(MBESS) 
library(dplyr) 
library(mice) 
library(tidyverse) 
library(GGally) 
library(mediation)
```

### Outline:

The dataset for this assignment comes from a study by Dr. Bob Altemeyer from the University of Manitoba. Dr. Altemeyer primarily studied right wing authoritarianism' (RWA, personality trait of someone who is highly submissive to their authority figures, acts aggressively in the name of said authorities, and is conformist in thought and behavior).

#### Variables:

-   **rwas**: Level of Submissiveness to Authorities. RWA scale, average score across 22 seven-point Likert items,
-   **age**:
-   **education**:
    1.  less than high school
    2.  high school
    3.  college/university)
    4.  graduate/professional degree
-   **TIPI10**: Level of conventional/uncreative personality, 1-7 Likert scale
-   **gender**:

------------------------------------------------------------------------

### Loading data and Verification:

```{r}
# Load the data
d <- read.csv ("~/Desktop/P4330/P4330 R code/P4330_Assignment01/rwas_altemeyer.csv") 
str(d)
head(d)
```

------------------------------------------------------------------------

#### Part A

For this question we are interested in predicting rwas from age, education, TIPI10, and gender. *We are going to treat education as a factor in this question (with "high school" education as the reference category).*

**\*Due to some missing data, we will use multiple imputation (4 imputed datasets) for the analysis. You can skip testing assumptions for this analysis.**

Initial Data Processing

```{r}

# Change education to factor and assign each level a name
d <- d %>%
  mutate(education = factor(education,
                            levels = c(1, 2, 3, 4),
                            labels = c(": Less than high school", ": High school", 
                                       ": Coll/Univ", ": Grad/Prof_Dg")))

# Check for missingness in the dataset
md.pattern(d)
```

#### Conduct Multiple Imputation

```{r}
#Impute data using Multiple Imputation 
Mul_Imp_10 <- mice(d, method = "norm.nob", m = 10, printFlag = FALSE)
d_Mul_Imp_10 <- complete(Mul_Imp_10)

# Confirm the imputation
md.pattern(d_Mul_Imp_10)
```

##### 1) Summarize the null hypothesis testing results, using a = .10. 

```{r}
names(d)

# Build a Full-model for a comparison purposes (including missing values)
Full_m <- lm(rwas ~ age + education + TIPI10 + gender, data = d)
summary(Full_m)
confint(Full_m)

# Build an Imputated model
Mul_Imp_m <- lm(rwas ~ age + education + TIPI10 + gender, data = d_Mul_Imp_10) 
summary(Mul_Imp_m)
confint(Mul_Imp_m)
```

##### 2) Interpret each unstandardized effect. 

##### 3) Recalculate the standard error for the age effect using Eqs 1:3 from Baraldi & Enders. 

##### 4) Interpret the magnitude of the gender effect (do your best... I know you are not RWA researchers).

#### Part B

For this part we are interested in whether education mediates the relationship between age and rwas. We are going to treat education as a continuous variable, and use stochastic regression imputation. Use bootstrapping for the analysis (1000 samples).

##### 1) Summarize the null hypothesis testing results for the indirect effect, using a = .01. You can use the p-value for this analysis. 

##### 2) Interpret the coefficient for the indirect effect. 

##### 3) Use effect size measures to discuss the magnitude of the indirect effect.
