---
title: "P4330_Assignment01"
author: "Ken Suzuki"
date: "2023-10-21"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, message = FALSE)

# List of required functions
library(flexplot) 
library(MBESS) 
library(mice) 
library(tidyverse) 
library(GGally) 
library(mediation)
library(psych)
```

### Outline:

The dataset for this assignment comes from a study by Dr. Bob Altemeyer from the University of Manitoba. Dr. Altemeyer primarily studied right wing authoritarianism' (RWA, personality trait of someone who is highly submissive to their authority figures, acts aggressively in the name of said authorities, and is conformist in thought and behavior).

#### Variables:

-   **rwas**: Level of Submissiveness to Authorities. RWA scale, average score across 22 seven-point Likert items,
-   **age**:
-   **education**:
    1.  less than high school
    2.  high school
    3.  college/university)
    4.  graduate/professional degree
-   **TIPI10**: Level of conventional/uncreative personality, 1-7 Likert scale
-   **gender**:

------------------------------------------------------------------------

### Loading data and Verification:

```{r}
# Load the data
d <- read.csv ("~/Desktop/P4330/P4330 R code/P4330_Assignment01/rwas_altemeyer.csv") 
str(d)
head(d)
```

------------------------------------------------------------------------

#### Part A

For this question we are interested in predicting rwas from age, education, TIPI10, and gender. *We are going to treat education as a factor in this question (with "high school" education as the reference category).*

**\*Due to some missing data, we will use multiple imputation (4 imputed datasets) for the analysis. You can skip testing assumptions for this analysis.**

Initial Data Processing

```{r}

# Change education to factor and assign each level a name
d <- d %>%
  mutate(education = factor(education,
                            levels = c(1, 2, 3, 4),
                            labels = c(": Less than high school", ": High school", 
                                       ": Coll/Univ", ": Grad/Prof_Dg")))

summary(d)

# Check for missingness in the dataset
md.pattern(d)
```

#### Conduct Multiple Imputation

```{r}
# Setting seed so that the imputed values don't change while rerunning the code for checking and fixing (I noticed that every time I "Knit" my imputation values change, leading to descrepancies between Imputed Linear Model summary and my already written report)
set.seed(123)

#Impute data using Multiple Imputation 
Mul_Imp_10 <- mice(d, method = "norm.nob", m = 10)
d_Mul_Imp_10 <- complete(Mul_Imp_10)

# Confirm the imputation
md.pattern(d_Mul_Imp_10)
```

#### Question 1 and 2

1.  Summarize the null hypothesis testing results, using a = .10.

2.  Interpret each unstandardized effect.

```{r}
names(d)

# Build an Imputated model
Mul_Imp_m <- lm(rwas ~ age + education + TIPI10 + gender, data = d_Mul_Imp_10) 
summary(Mul_Imp_m)
confint(Mul_Imp_m)
```

#### Interpretation (I did not set the seed before beginning to write this report)

*Please note that the summary's interpretation is contingent on the imputed results available at the time this report was written. Discrepancies between the summary and this interpretation may arise from subsequent imputation or reruns of the code, conducted for functional checks or corrections in both sections A and B of the assignment.*

*Thus, the summary serves primarily as an indicator of due diligence in completing the assignment, rather than as a definitive reflection of the exact values shown in the summary section and values discussed in this interpretation.*

##### **Intercept**:

Based on the list of Coefficients, the intercept represents the estimated mean value (4.991736) of the level of submissiveness to the authority (RWA) for the gender classified as females who have an education level of less than high school. The corresponding p-value of less than a= 0.1 indicates that the null hypothesis is rejected and supports the alternate hypothesis that the baseline is "not non-zero" when all other variables are held constant.

##### Age

Based on a = 0.1 the p-value (0.61609) is larger. Therefore, age is not statistically significant. However, the estimate value indicates that for every one-year increase in age, there is an estimated decrease of 0.002716 units in RWA score holding all other variables constant.

##### Education: High School

The RWA value for people with high school education is estimated at -0.308570, on average, compared to the females with less than high school education. This value indicates those who have high school education are estimated to have less RWA scores compared to the base population. The corresponding p value is p=0.08952, and based on a = 0.1, the null hypothesis is rejected and high school education is statistically significant for predicting RWA. In this case, a unit-increase indicates the target individuals have high school educations.

##### Education: College/University

The RWA value for people with college or university education is estimated at -0.458510 compared to the base population, on average. Based on the a = 0.1 threshold, the corresponding p value = 0.03991 is statistically significant. Therefore, the null hypothesis is rejected and supports the alternative hypothesis that having college and/or university education have the statistically significant effect on RWA score.

##### Education: Grad/Prof_Dg

Furthermore, the RWA value for people with Graduate or Professional degrees is estimated at -0.642179 compared to the base population. The corresponding low p value of 0.01110 indicates that higher education such as graduate degree or above is a statistically significant predictor for lower RWA score compared to those who have less education background.

##### TIPI10

The variable **TIPI10** is also statistically significant (p = 0.00837) in predicting one's RWA score based on a = 0.10. This very small value indicates that for every one-unit increase in TIPI10, the RWA is estimated to go up by 0.096468 on average.

##### Gender(Male)

Lastly, male participants have higher RWA score by 0.226626 on average. However, TIPI10 is not statistically significant (p = 0.11741) when a = 0.10. It failed to reject the null hypothesis and the higher unit scores deemed as not statistically significant.

------------------------------------------------------------------------

##### 3) Recalculate the standard error for the age effect using Eqs 1:3 from Baraldi & Enders.

SE = √W+B+B/m
W = Sum of SE²t / m
B = Sum(estimated parameter estimate - mean of parameter

##### 4) Interpret the magnitude of the gender effect (do your best... I know you are not RWA researchers).

#### Part B

For this part we are interested in whether education mediates the relationship between age and rwas. We are going to treat education as a continuous variable, and use stochastic regression imputation. Use bootstrapping for the analysis (1000 samples).

##### 1) Summarize the null hypothesis testing results for the indirect effect, using a = .01. You can use the p-value for this analysis.

##### 2) Interpret the coefficient for the indirect effect.

##### 3) Use effect size measures to discuss the magnitude of the indirect effect.
